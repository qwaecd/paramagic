# 参数魔法 (Paramagic)

## 基本设定

### 名词解释

英文释义优先，中文释义按 mod 描述选取和定义。

**说明格式**
```
英文释义（中文释义）：中文解释
```

- **para (参数单元)**：构成魔法的基础模块。每个“参数单元”都包含一种几何图形，是魔法阵视觉和功能的基本载体。取自 "parameter"。
- **paralgorhythm (参数算法式)**：由多个“参数单元”以树状结构组合而成的完整魔法。它不仅定义了魔法阵的华丽外观和动态效果，还决定了最终释放的魔法效果。取自 "parameter" + "algorithm" + "rhythm"。

## 玩法介绍

在“参数魔法”中，你不是学习固定的咒语，而是成为魔法的设计者。一个完整的魔法（`paralgorhythm`）由你亲手分步构建，主要包括 **设计外观** 和 **定义功能** 两个核心步骤。

### 步骤一：设计魔法阵的外观

魔法始于构图。你需要创建数个“参数单元”（`para`），并为它们指定不同的几何图形（如圆形、三角形、正方形等）。

随后，你需要像搭建积木一样，将这些“参数单元”以父子关系组合成一个树状结构。这个结构就是你魔法阵的蓝图，它不仅决定了各个几何图形的相对位置，也为后续的功能定义打下了基础。

**示例：**
1.  创建四个参数单元：A (正方形), B (三角形), C (圆形), D (五角星)。
2.  搭建结构：
    - 将 B 和 C 设置为 A 的子单元。
    - 将 D 设置为 B 的子单元。
    - 最终形成 `D -> B -> A` 和 `C -> A` 的树状结构。

### 步骤二：定义魔法的功能

外观只是起点，功能才是魔法的灵魂。你需要为你创建的每个“参数单元”赋予具体的魔法效果。这些效果大致可以分为三类：

- **核心效果**：决定魔法的本质，例如“爆炸”、“治疗”或“召唤闪电”。通常由树结构的根节点承担。
- **目标指令**：决定魔法在哪里或对谁生效，例如“指向视线所及的方块”、“指向自身”或“影响半径5米内的所有生物”。
- **修饰效果**：调整或增强其他效果，例如“强度加倍”、“范围扩大”、“延迟触发”或“持续燃烧”。

当魔法被释放时，所有“参数单元”的效果会根据它们在树状结构中的位置进行算法组合，最终呈现出一个独一-无二的法术。

**重要规则：**
- **修饰范围**：子节点的修饰效果 **只会** 影响其直接的父节点。
- **效果冲突**：当存在多个同类效果（如多个目标指令）时，系统在遍历树结构时， **后处理的效果会覆盖先处理的**。 (注意：该部分算法仍在开发中，具体表现未来可能调整。)

**续上例：**
1.  为根单元 **A (正方形)** 定义核心效果：**“爆炸”**。
2.  为子单元 **C (圆形)** 定义目标指令：**“指向面前的方块”**。
3.  为子单元 **B (三角形)** 定义修饰效果：**“强度加强”**。
4.  为孙单元 **D (五角星)** 定义修饰效果：**“效果数值x2”**。

**最终效果：**
> 根据规则，D 的“x2”效果作用于其父节点 B，使 B 的效果变为“双倍的强度加强”。然后，这个新效果与 C 的目标指令一同作用于根节点 A。
>
> 最终效果为：在 **{面前的方块}** 上，执行一次 **{爆炸}**，其爆炸强度受到了 **{双倍的强度加强}** 效果的增幅。

通过这种方式，你可以自由组合，创造出威力强大、功能独特的原创魔法！

### (可选) 步骤三：添加动画

当你的魔法可以正常运作后，还可以为其附加动画器。你可以设计每个几何图形的旋转、缩放、发光等视觉特效，让你的魔法阵在施放时更加炫酷。

这部分是 **纯粹的视觉效果**，不会影响法术的实际功能（如伤害、范围）或施法时间。

## 开发进度

### 已完成
- 与 Minecraft 解耦的底层渲染系统
- Bloom 效果
- 基本 Para 的渲染实现
- 数据驱动的魔法阵构建
- 数据驱动的关键帧动画以及动画与法阵的结合
- GPU 粒子
- 挂载到 Entity 上的魔法阵
- 服务端客户端数据/动画同步

### 待完成
- 更丰富的法术位置确定方式

### 计划中
- 魔法效果的抽象语法树

## 信息
### OpenGL
- 本 mod 直接使用 OpenGL 进行渲染，可能与某些光影或其他优化 OpenGL 的 mod 存在兼容性问题。比如 Iris 的特定光影会出现遮挡错误的问题。
- 推荐使用 OpenGL 4.3 及以上版本，最低 OpenGL 版本为 3.2，低于该版本的 OpenGL 可能无法正常运行。
- 低于 OpenGL 4.3 的版本可能会出现部分功能不可用的情况，取决于显卡驱动的实现。如果遇到渲染问题，建议尝试更新显卡驱动，或者提升 OpenGL 版本。